var __bind=function(t,i){return function(){return t.apply(i,arguments)}};define(["jquery","util/util"],function(t,i){var e;return e=function(){function e(i){this.options=i,this.removeHoverClassEvent=__bind(this.removeHoverClassEvent,this),this.touchDropdownEvent=__bind(this.touchDropdownEvent,this),this.moreLinkEvent=__bind(this.moreLinkEvent,this),this.options=t.extend({},this.defaults,this.options),this.additionalSelectors(),this.calcInitMoreWidth(),this.delegateEvents(),this.calcNavWidth(),this.moreLinkEvent()}return e.prototype.defaults={element:"#pageHeader",navWrap:".sub-navigation-wrap:eq(0)",navList:".sub-navigation:eq(0)",navItems:"li",hoverClass:"atp-touch-hover",wrapperInner:".page-header-holder:eq(0)",moreText:"More",moreWidth:98,wrapperInnerPadding:31},e.prototype.additionalSelectors=function(){return this.options.$element=t(this.options.element),this.options.$navWrap=this.options.$element.find(this.options.navWrap),this.options.$navList=this.options.$element.find(this.options.navList),this.options.$navItems=this.options.$element.find(this.options.navItems),this.options.$wrapperInner=this.options.$element.find(this.options.wrapperInner),this.options.$window=t(window),this.options.$body=t("body"),this.options.$html=t("html")},e.prototype.delegateEvents=function(){var i,e;return this.calcNavWidth(),e="resize."+this.options.element.substring(1),i="click."+this.options.element.substring(1),this.options.$window.off(e),this.options.$window.on(e,this.moreLinkEvent),t(document).off(i),t(document).on(i,".page-header-more-link > a",this.touchDropdownEvent),this.moreLinkEvent(),this.additionalSelectors(),this.moreLinkEvent()},e.prototype.calcInitMoreWidth=function(){var i;return i=t("<li class='page-header-more-link'><a>"+this.options.moreText+"</a></li>"),this.options.$navList.append(i),this.additionalSelectors(),i=this.options.$navList.find(i),this.options.moreWidth=i.outerWidth(),i.remove()},e.prototype.calcNavWidth=function(){var i,e;return this.options.wrapperInnerWidth=this.options.$wrapperInner.width(),i=1,this.options.$navWrap.siblings().not("div[data-placeholder-script],script,.filter-holder:not(.exposed)").each(function(){return i+=t(this).outerWidth(!0)}),e=this.options.wrapperInnerWidth-i,this.options.$navWrap.css({width:e})},e.prototype.moreLinkEvent=function(){var t;return this.options.$body.hasClass("is-mobile")?void 0:(this.additionalSelectors(),t=this.options.$navList.find(".page-header-more-link"),this.options.$navList.append(t.find("ul").html()),t.remove(),this.calcNavWidth(),this.alignMenu())},e.prototype.alignMenu=function(){var i,e,o,n;return this.additionalSelectors(),n=1,o=this.options.$navWrap.width(),e="",i=1,t.each(this.options.$navList.children(),function(){return i+=t(this).outerWidth(!0)}),i>o&&(o-=this.options.moreWidth),t.each(this.options.$navList.children(),function(){n+=t(this).outerWidth(!0),n>o&&(e+=t("<div>").append(t(this).clone()).html(),t(this).remove())}),e.length&&this.options.$navList.append("<li class='page-header-more-link'><a>"+this.options.moreText+"</a><ul class='page-header-sub-nav'>"+e+"</ul></li>"),this.options.$element.find(".page-header-more-link").length?this.options.moreWidth=this.options.$element.find(".page-header-more-link").outerWidth(!0):void 0},e.prototype.touchDropdownEvent=function(e){var o,n,s;return e.preventDefault(),n=t(e.currentTarget),o=n.parent(),s=n.attr("href"),(this.options.$html.hasClass("device-using-touch")||i.isIpad())&&(o.hasClass(this.options.hoverClass)||(o.siblings().removeClass(this.options.hoverClass),o.addClass(this.options.hoverClass))),!0},e.prototype.removeHoverClassEvent=function(i){var e,o;return e=t(i.target),o=t(i.currentTarget),!e.closest("."+this.options.hoverClass).length||e.hasClass(this.options.hoverClass)?t("."+this.options.hoverClass).removeClass(this.options.hoverClass):void 0},e}()});