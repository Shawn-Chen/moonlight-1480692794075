var __bind=function(t,e){return function(){return t.apply(e,arguments)}};define(["jquery","modules/global/moreLink","modules/global/largeDropinAd","modules/page/filter","modules/global/subNavigation","modules/featured/longForm","modules/modal/modal","util/util"],function(t,e,o,i,n,a,s,r){var l;return l=function(){function i(){}var l,p;return p=null,i.get=function(t){return this.options=t,null!=p?p:p=new l(this.options)},l=function(){function i(e){this.options=e,this.transitionUpdatePage=__bind(this.transitionUpdatePage,this),this.options=t.extend({},this.defaults,this.options),this.additionalSelectors()}return i.prototype.defaults={pageHeader:"#pageHeader",largeDropin:"#largeDropin",mainContainer:"#mainContainer",filterHolder:"#filterHolder",navigation:"#navigation",html:"html",body:"body",wrapper:"body > .wrapper",longForm:"#longForm",mainNav:"#mainNav",mainHeader:"#mainHeader",subNavigation:".header-sub-navigation",headerCallouts:".header-callouts",pageHeaderTemplate:"#pageHeaderTemplate",subNavigationTemplate:"#subNavigationTemplate",largeDropinTemplate:"#largeDropinTemplate",longFormTemplate:"#longFormTemplate",headerCalloutsTemplate:"#headerCalloutsTemplate",transitionDelay:250},i.prototype.additionalSelectors=function(){return this.options.$pageHeader=t(this.options.pageHeader),this.options.$largeDropin=t(this.options.largeDropin),this.options.$mainContainer=t(this.options.mainContainer),this.options.$filterHolder=t(this.options.filterHolder),this.options.$navigation=t(this.options.navigation),this.options.$html=t(this.options.html),this.options.$body=t(this.options.body),this.options.$wrapper=t(this.options.wrapper),this.options.$longForm=t(this.options.longForm),this.options.$mainNav=t(this.options.mainNav),this.options.$mainHeader=t(this.options.mainHeader),this.options.$subNavigation=t(this.options.subNavigation),this.options.$headerCallouts=t(this.options.headerCallouts),this.options.$pageHeaderTemplate=t(this.options.pageHeaderTemplate),this.options.$subNavigationTemplate=t(this.options.subNavigationTemplate),this.options.$largeDropinTemplate=t(this.options.largeDropinTemplate),this.options.$longFormTemplate=t(this.options.longFormTemplate),this.options.$headerCalloutsTemplate=t(this.options.headerCalloutsTemplate)},i.prototype.isModalOpen=0,i.prototype.willOpenModal=0,i.prototype.transitionStart=function(){var e;return this.isModalOpen=t("#modal").length,this.previousPageTransitionTitle=t("meta[property='pageTransitionTitle']"),(null!=(e=this.previousPageTransitionTitle)?e.length:void 0)&&(this.previousPageTransitionTitle=this.previousPageTransitionTitle.attr("content").trim()),window.app.FilteredModules&&t("#playerProfileHero").length&&this.options.$html.addClass("transition-content-on--player-profile"),window.app.FilteredModules||window.app.OverrideTransition?!1:(this.additionalSelectors(),this.closeExpandedItems(),this.scrollToTop(),this.isModalOpen?void 0:this.options.$html.addClass("transition-content-on"))},i.prototype.transitionEnd=function(){var e,o,i,n,a,s;return e=t(this.response),n=e.find(".modal").length||e.hasClass("modal"),a=e.find("[data-filtered-module]").length,i=e.filter("meta[property='pageTransitionTitle']"),(null!=i?i.length:void 0)&&(i=i.attr("content").trim(),o=i===this.previousPageTransitionTitle),window.app.FilteredModules&&a&&o?(this.updateFilteredModules(),this.modifyResponse(),this.updateOutsideElements(1),this.options.$html.removeClass("transition-content-on--player-profile"),!1):(this.options.$html.removeClass("transition-content-on--player-profile"),n===!1&&this.scrollToTop(),this.isModalOpen?n?(s=e.find("#modal"),0===s.length&&(s=e),this.modal.modalTransition(s)):(this.transitionUpdatePage(),setTimeout(function(t){return function(){return t.modal.closeModal(window.location.pathname,!0)}}(this),2*this.options.transitionDelay+this.modal.options.transitionDelay)):n?(this.modal.openModal(t(this.response)),setTimeout(function(t){return function(){return t.options.$html.removeClass("transition-content-on")}}(this),this.modal.options.transitionDelay)):this.transitionUpdatePage())},i.prototype.transitionUpdatePage=function(){return setTimeout(function(t){return function(){return t.updatePage(),setTimeout(function(){return t.options.$html.removeClass("transition-content-on")},t.options.transitionDelay)}}(this),this.options.transitionDelay)},i.prototype.closeExpandedItems=function(){var e,o,i,n,a,s,r,l,p,d;return null!=(e=this.options.$filterHolder)&&e.removeClass("expand"),null!=(o=this.options.$largeDropin)&&o.removeClass("expand"),this.options.$navigation.removeClass("expand"),this.options.$html.removeClass("full-nav"),null!=(i=this.options.$html)&&i.removeClass("long-form-on"),t("html").removeClass("modal-carousel-on"),t(".modal-carousel-wrapper").remove(),t(".atp-touch-hover").removeClass("atp-touch-hover"),null!=(n=this.options.$mainNav)&&n.removeClass("expand"),null!=(a=this.options.$subNav)&&a.removeClass("expand"),null!=(s=this.options.$subNavLink)&&s.removeClass("expand"),null!=(r=this.options.$menuToggle)&&r.removeClass("expand"),null!=(l=this.options.$mainHeader)&&l.removeClass("expand"),null!=(p=this.options.$navigation)&&p.removeClass("expand"),null!=(d=this.options.$html)&&d.removeClass("full-nav"),t("#mainNav, .nav-push, #controlMenu").removeClass("expand"),t("#closeSearch").trigger("click")},i.prototype.scrollToTop=function(){return t("html, body").stop().animate({scrollTop:0})},i.prototype.modal=new s,i.prototype.updateFilteredModules=function(){var e,o;return e=t(this.response),t("[data-filtered-module]").each(function(){var o,i;return i="[data-filtered-module='"+t(this).data("filtered-module")+"']",o=e.find(i).html()||e.filter(i).html(),t(this).html(o)}),o=t(this),e.filter("[data-filtered-module-forced]").each(function(){var e,i;return i="[data-filtered-module='"+t(this).data("filtered-module")+"']",e=o.find(i)||o.filter(i),e.length?e.html(t(this).html()):t("#mainContent").append(this.outerHTML)})},i.prototype.updatePageHeader=function(){var e,o,i,n,a,s,l,p,d,h;return o='<div class="page-header-holder"></div>',null!==this.pageHeaderHtml&&void 0!==this.pageHeaderHtml?(i=this.pageHeaderHtml.trim(),h=""!==i?this.pageHeaderHtml:o):h=o,e=t(h),p=this.options.$pageHeader.find(".page-title").text().trim()||this.options.$pageHeader.find(".page-title img").attr("src"),a=e.filter(".page-title").text().trim()||this.options.$pageHeader.find(".page-title img").attr("src"),s=e.filter("#filterScript"),d=e.not(s),p===a&&null!=d&&""!==d?(this.options.$pageHeader.find(".page-header-holder").html(d),s.length&&this.options.$pageHeader.find(".page-header-holder").append(s),r.checkPageHeader(t(h)),this.moreLinkInit()):d?(d=d.wrapAll("<div class='page-header-holder'></div>").parent(),this.options.$pageHeader.append(d||o),l="translateY(110px)",n="translateY(0)",this.options.$html.addClass("transition-header-on"),setTimeout(function(t){return function(){return t.options.$pageHeader.find(".page-header-holder").eq(0).css({"-webkit-transform":l,"-moz-transform":l,"-ms-transform":l,transform:l,opacity:0,position:"absolute",top:0,left:0,"z-index":1})}}(this),this.options.transitionDelay/2),setTimeout(function(e){return function(){return e.options.$pageHeader.find(".page-header-holder").eq(1).css({"-webkit-transform":n,"-moz-transform":n,"-ms-transform":n,transform:n,opacity:1},setTimeout(function(){return e.options.$pageHeader.find(".page-header-holder").eq(0).remove(),r.checkPageHeader(t(h)),s.length&&e.options.$pageHeader.find(".page-header-holder").append(s),e.options.$html.removeClass("transition-header-on"),e.options.$pageHeader.find(".page-header-holder").eq(0).removeAttr("style")},e.options.transitionDelay))}}(this),this.options.transitionDelay),this.moreLinkInit()):this.options.$pageHeader.find(".page-header-holder").empty()},i.prototype.moreLinkInit=function(){return setTimeout(function(){return new e({element:"#subNavigation",navWrap:".header-sub-navigation-list-wrap",navList:".header-sub-navigation-list",wrapperInner:".container",wrapperInnerPadding:31}),new e({wrapperInnerPadding:16}),t(window).trigger("resize")},500)},i.prototype.updatePage=function(){return this.options.$wrapper.children('[data-outside-element="largeDropin"]').remove(),this.modifyResponse(),t("#mainContent").remove(),this.options.$mainContainer.append(this.modifiedResponse),this.additionalSelectors(),this.updateOutsideElements(1e3),r.setModalContainer(),r.setSponsoredBackground()},i.prototype.modifyResponse=function(){var e,o,i,n,a,s;return s=this,o=t(this.response),i=o.filter("#largeDropin"),n=i.wrap('<div data-outside-element="largeDropin"></div>').parent(),e=o.filter("[data-outside-element]"),e=e.add(n),this.newMeta=o.filter("meta"),this.newTitle=o.filter("title"),this.modifiedResponse=o.not(e),this.modifiedResponse=this.modifiedResponse.not(this.newMeta),this.modifiedResponse=this.modifiedResponse.not(this.newTitle),this.modifiedResponse=this.modifiedResponse.not(i),a=this,e.each(function(){var e,o,i;return e=t(this),i=e.data("outside-element"),o=e.html(),"pageHeader"===i?s.pageHeaderHtml=o:"largeDropin"===i?a.options.$wrapper.prepend(e):t("[data-outside-element='"+i+"']").html(o)}),this.updateHeaderTags()},i.prototype.updateHeaderTags=function(){var e,o,i;return o=t("meta"),i=t("title"),e=t("head"),o.remove(),e.prepend(this.newMeta),i.remove(),e.prepend(this.newTitle)},i.prototype.updateLargeDropin=function(){var t;this.options.$largeDropin.length&&(t=this.options.largeDropin,this.options.$wrapper.children(t).empty().remove()),new o({openAdTimeout:2e3})},i.prototype.updateSubNavigation=function(e){return setTimeout(function(e){return function(){var o,i;return e.additionalSelectors(),i=null!=(o=e.options.$subNavigationTemplate)?o.html():void 0,i?(e.options.$subNavigation.remove(),t(i).insertAfter(e.options.mainHeader),e.options.$body.hasClass("is-mobile")?new n:void 0):e.options.$subNavigation.remove()}}(this),e||2.1*this.options.transitionDelay)},i.prototype.updateHeaderCallouts=function(){var e,o;return o=null!=(e=this.options.$headerCalloutsTemplate)?e.html():void 0,o?this.options.$headerCallouts.length?this.options.$headerCallouts[0].outerHTML=o:t(o).insertAfter(this.options.mainHeader):this.options.$headerCallouts.remove()},i.prototype.updateLongForm=function(){var t,e;return e=null!=(t=this.options.$longFormTemplate)?t.html():void 0,e?(this.options.$longForm.length?this.options.$longForm[0].outerHTML=e:this.options.$body.append(e),setTimeout(function(){return function(){return new a}}(this),this.options.transitionDelay)):setTimeout(function(t){return function(){var e;return null!=(e=t.options.$longForm)?e.remove():void 0}}(this),this.options.transitionDelay)},i.prototype.updateStickyNav=function(){},i.prototype.updateOutsideElements=function(t){return this.additionalSelectors(),this.updateSubNavigation(t),this.updateHeaderCallouts(),this.updatePageHeader(),this.updateLongForm(),this.updateStickyNav()},i}(),i}()});